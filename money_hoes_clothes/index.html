
<html>
  <head>
    <title>My first Three.js app</title>
    <style>
      body { margin: 0; }
      canvas { width: 100%; height: 100% }
    </style>
    <script src="/public/three.min.js"></script>
    <script src="https://ajax.googleapis.com/ajax/libs/jquery/2.1.4/jquery.min.js"></script>
    <script src="/public/FirstPersonControls.js"></script>

  </head>
  <body>
    <!-- Div which will hold the Output -->
    <div id="WebGL-output">
    </div>

  <script>
      // ajax call 
      $(function() {
        console.log("Sending request to server...")
          $.ajax({
            url: 'http://localhost:3000/index',
            method: 'GET',
            type: 'json',
            success: function(data) {
              console.log('working');
              sphereMaker(data);
            }
          });
        });
      
      var clock = new THREE.Clock();

      // set scene 
      var scene = new THREE.Scene();

      var camera = new THREE.PerspectiveCamera( 45, window.innerWidth / window.innerHeight, 0.2, 20 );

      var renderer = new THREE.WebGLRenderer();
      renderer.setSize( window.innerWidth, window.innerHeight );
      document.body.appendChild( renderer.domElement );

      // // fly controls
      // // position and point the camera to the center of the scene
        camera.position.x = 0;
        camera.position.y = 0;
        camera.position.z = 1;
        camera.lookAt(new THREE.Vector3(0, 0, 0));

        camera.setLens(1)
      //   // fly controls
      //   var flyControls = new THREE.FlyControls(camera);
      //   flyControls.movementSpeed = 25;
      //   flyControls.domElement = document.querySelector("#WebGL-output");
      //   flyControls.rollSpeed = Math.PI / 24;
      //   flyControls.autoForward = true;
      //   flyControls.dragToLook = false;
      // // end controls
      var camControls = new THREE.FirstPersonControls(camera);
        camControls.lookSpeed = 0.1;
        camControls.movementSpeed = 5;
        camControls.noFly = true;
        camControls.noZoom = true;
        camControls.autoForward = false;
        camControls.lookVertical = true;
        camControls.constrainVertical = true;
        camControls.verticalMin = 1.0;
        camControls.verticalMax = 2.0;
        camControls.lon = -150;
        camControls.lat = 120;

      // // add the output of the renderer to the html element
      // $("#WebGL-output").append(webGLRenderer.domElement);

      // create a point light
      // var pointLight = new THREE.PointLight(0xFFFFFF);

      // // set its position
      // pointLight.position.x = 60;
      // pointLight.position.y = 50;
      // pointLight.position.z = 130;

      // add to the scene
      scene.add(pointLight);

    // builds sphere (clearly)
    function sphereMaker(position) {
      for(i=0; i<300; i++){
        var x = position[i]['x']
        var y = position[i]['y']
        var z = position[i]['z']

        var geometry = new THREE.SphereGeometry( .04513, 20, 20 );
        //.00000004513 actual size (think about scaling up the distance to make them larger if there are canvas rendering issues????)
        var material = new THREE.MeshBasicMaterial( );
        THREE.ImageUtils.crossOrigin = '';
        material.map  = THREE.ImageUtils.loadTexture('/public/sunFinal.jpg');

        var sphere = new THREE.Mesh( geometry, material );
        sphere.position.set(x, y, z);

        scene.add( sphere );
      }
      render();

    }
    // end spheremaker 

      function render() {
      var delta = clock.getDelta();
      requestAnimationFrame( render );
      camControls.update(delta);
      // pointLight.position.x += -.4;
      // pointLight.position.y += -.4;
      // pointLight.position.z += ;

      renderer.render( scene, camera );

      }

      // render



  </script>

  <p>hello, I'm workign</p>
 
  </body>
</html>